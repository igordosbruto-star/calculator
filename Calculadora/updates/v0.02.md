# v0.02.md — Tipos de materiais & Persistência (App Ducally)

> **Objetivo:** implementar um fluxo completo para **gerar, salvar, carregar e comparar** materiais, separados por tipo. Este arquivo serve de roteiro para o Codex aplicar mudanças incrementais no código C++ atual.

---

## 1) Contexto atual (baseline)
- O app já:
  - Lê/salva **materiais** do tipo area em `data/materiais.json` e importa/exporta **CSV**.

## 2) Alvo deste update
  - **Gerar** material do tipo unitario em `data/materiais_unitarios.json`.
  - **Importar e exportar** materiais unitarios.
  - **Persistir** os materiais unitarios em um **arquivo externo** por execução.
  - **Reabrir** os materiais unitarios gerado anteriormente.
  - **Comparar** os valores dos materiais unitarios (histórico/benchmark).

---


## 3) DTOs e Schemas sugeridos
### 3.1 `CorteDTO` (persistência)

### 3.2 JSON do `materiais.json` (exemplo mínimo)

### 3.3 CSV do `materiais_unitarios.csv`
```
nome;un;qtd;valor;
tecido;m,1;10
```

### 3.5 Índice global (histórico)
Arquivo `out/materiais/index.json` para facilitar comparações


---

## 4) Persistência

---

## 5) Integração no fluxo atual

---

## 6) CLI (evolução)

---

## 7) Critérios de aceite
- Ao concluir uma execução, existe uma **pasta** em `out/planos/<id>/` com **`plano.json` e `plano.csv`** válidos.
- `index.json` contém a execução recém-criada.
- Reabrir um plano via `loadPlanoJSON` reproduz os totais mostrados no terminal.

---

## 8) Testes (mínimo viável)
- **Unit**: `to_json/from_json` de `CorteDTO` e `PlanoCorteDTO`.
- **I/O**: `savePlanoJSON/CSV` + leitura do que foi salvo.
- **Index**: insere N entradas e confere integridade do arquivo.

---

## 9) Passos de implementação (ordem sugerida)

---

## 10) Notas de compatibilidade


> Após estes passos, teremos materiais separados por tipo **unitarios, lineares e cubicos**.

